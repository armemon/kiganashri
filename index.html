<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>

    <script defer src="/__/firebase/9.8.4/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/9.8.4/firebase-database-compat.js"></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<style>
    th {
        color: #000000;
    }

    .modal {
        display: none;
        /* Hidden by default */
        position: fixed;
        /* Stay in place */
        z-index: 1;
        /* Sit on top */
        padding-top: 100px;
        /* Location of the box */
        left: 0;
        top: 0;
        width: 100%;
        /* Full width */
        height: 100%;
        /* Full height */
        /*overflow: auto; !* Enable scroll if needed *!*/
        background-color: rgb(0, 0, 0);
        /* Fallback color */
        background-color: rgba(0, 0, 0, 0.4);
        /* Black w/ opacity */
    }

    /* tempModal Content/Box */
    .modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        /* 15% from the top and centered */
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        /* Could be more or less, depending on screen size */
    }

    .modal-header {
        padding: 2px 16px;
        background-color: #23408e;
        color: white;
    }

    /* The Close Button */
    .close {
        color: white;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    /*body{*/
    /*    font-family: 'Share Tech', sans-serif;*/
    /*    font-size: 68px;*/
    /*    color: white;*/
    /*    display: flex;*/
    /*    justify-content: center;*/
    /*    align-items: center;*/
    /*    margin: 0;*/
    /*    width: 100vw;*/
    /*    height: 100vh;*/
    /*    text-shadow: 8px 8px 10px #0000008c;*/
    /*    background-color: #343a40;*/
    /*    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%239C92AC' fill-opacity='0.25' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"), linear-gradient(to right top, #343a40, #2b2c31, #211f22, #151314, #000000);*/
    /*}*/
</style>

<body>
    <div class="container">
        <div class="row" style="text-align: center; padding: 30px 0;">
            <div class="col-md-3"></div>
            <div class="col-md-3">
                <h3 id="currentDate"></h3>
            </div>
            <div class="col-md-3">
                <h3 id="currentTime"></h3>
            </div>
            <div class="col-md-3"></div>
        </div>

        <div id="temperatureModal" class="modal">

            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <h2>Temperature Dashboard</h2>
                </div>

                <div class="modal-body">
                    <select id="temperatureDateArray" onchange="selectTemperatureOption()"></select>
                    <canvas id="temperatureChart"></canvas>
                </div>

                <div class="modal-footer">
                </div>
            </div>

        </div>


        <div id="humidityModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <h2>Humidity Dashboard</h2>
                </div>
                <div class="modal-body">
                    <select id="humidityDateArray" onchange="selectHumidityOption()"></select>
                    <canvas id="humidityChart"></canvas>
                    <p>30% - 59% = Low Risk of Mold Growth</p>
                    <p>60% - 69% = Risk of Mold Growth</p>
                    <p>70% - 90% = High Risk of Mold Growth</p>

                </div>
                <div class="modal-footer">
                </div>
            </div>

        </div>

        <div id="airQualityModal" class="modal">

            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <h2>Carbon Dioxide Dashboard</h2>
                </div>

                <div class="modal-body">

                    <select id="airQualityDateArr" onchange="selectAirQualityOption()"></select>
                    <canvas id="airQualityChart"></canvas>
                </div>

                <div class="modal-footer">
                </div>
            </div>

        </div>

        <div id="smokeModal" class="modal">

            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <h2>Smoke Dashboard</h2>
                </div>

                <div class="modal-body">
                    <select id="SmokeDateArr" onchange="selectSmokeOption()"></select>
                    <canvas id="SmokeChart"></canvas>
                </div>

                <div class="modal-footer">
                </div>
            </div>

        </div>
        <div id="lpgModal" class="modal">

            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <h2>LPG Dashboard</h2>
                </div>

                <div class="modal-body">
                    <select id="LPGDateArr" onchange="selectLPGOption()"></select>
                    <canvas id="LPGChart"></canvas>
                </div>

                <div class="modal-footer">
                </div>
            </div>

        </div>

        <div id="coModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <h2>CO Dashboard</h2>
                </div>
                <div class="modal-body">
                    <select id="CODateArr" onchange="selectCOOption()"></select>
                    <canvas id="COChart"></canvas>
                </div>
                <div class="modal-footer">
                </div>
            </div>

        </div>



        <div class="row">
            <div id="temperatureIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
                <h5 style="color: #fff;">Temperature &#127777;</h5>
                <h1 id="latestTemperature" style="color: #fff;"></h1>
            </div>
            <div id="humidityIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
                <h5 style="color: #fff;">Humidity &#128167;</h5>
                <h1 id="latestHumidity" style="color: #fff;"></h1>
            </div>
            <div id="airQualityIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
                <h5 style="color: #fff;">Carbon Dioxide &#128168;</h5>
                <h1 id="latestAirQuality" style="color: #fff;"></h1>
            </div>
        </div>

        <div class="row mt-4">
            <div id="smokeIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
                <h5 style="color: #fff;">
                    Smoke &#127773;
                </h5>
                <h1 id="latestSmoke" style="color: #fff;"></h1>
            </div>
            <div id="lpgIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
                <h5 style="color: #fff;">
                    LPG &#127774;
                </h5>
                <h1 id="latestLPG" style="color: #fff;"></h1>
            </div>
            <div id="coIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
                <h5 style="color: #fff;">
                    CO &#127786;
                </h5>
                <h1 id="latestCO" style="color: #fff;"></h1>
            </div>
        </div>

        <script>
            function selectHumidityOption() {
                var selectedHumidDate = document.getElementById("humidityDateArray").value;
                console.log(selectedHumidDate);
                let selectedDayHumid = 'DHT11/Humidity/' + selectedHumidDate;
                console.log(selectedDayHumid);
                firebase.database().ref(selectedDayHumid).on('value', (snap) => {
                    var humidityStr = snap.val();
                    var humidityArray = [];

                    Object.keys(humidityStr).forEach((key) => {
                        humidityArray.push({ [key]: humidityStr[key] });
                    });
                    console.log(humidityArray);

                    var latestHumidity = humidityArray[humidityArray.length - 1];
                    var humidityValue = Object.values(latestHumidity);
                    var jsonHumidityVal = JSON.stringify(humidityValue);

                    jsonHumidityVal = jsonHumidityVal.split(":").pop();
                    jsonHumidityVal = jsonHumidityVal.replaceAll("\"", "");
                    jsonHumidityVal = jsonHumidityVal.replaceAll("}", "");
                    jsonHumidityVal = jsonHumidityVal.replaceAll("]", "");

                    var iterator = humidityArray.values();
                    console.log(iterator);
                    var dateArray = [];
                    var humidityValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        console.log(dateArray);
                        let cleanHumidity = JSON.stringify(Object.values(elements));
                        cleanHumidity = cleanHumidity.split(":").pop();
                        cleanHumidity = cleanHumidity.replaceAll("\"", "");
                        cleanHumidity = cleanHumidity.replaceAll("}", "");
                        cleanHumidity = cleanHumidity.replaceAll("]", "");
                        console.log(cleanHumidity);
                        humidityValueArray.push(cleanHumidity);
                        console.log(humidityValueArray);
                    }

                    new Chart("humidityChart", {
                        type: "line",
                        data: {
                            labels: dateArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: humidityValueArray
                            }]
                        },
                        options: {
                            legend: { display: false },
                            scales: {
                                yAxes: [{ ticks: { min: 20.00, max: 90.00 } }],
                            }
                        }
                    });
                });
            }

            function selectTemperatureOption() {
                var selectedTemperatureDate = document.getElementById("temperatureDateArray").value;
                console.log(selectedTemperatureDate);
                let selectedDayTemp = 'DHT11/Temperature/' + selectedTemperatureDate;
                console.log(selectedDayTemp);
                firebase.database().ref(selectedDayTemp).on('value', (snap) => {
                    var tempStr = snap.val();
                    var temperatureArray = [];

                    Object.keys(tempStr).forEach((key) => {
                        temperatureArray.push({ [key]: tempStr[key] });
                    });
                    console.log(temperatureArray);

                    var latestTemperature = temperatureArray[temperatureArray.length - 1];
                    var temperatureValue = Object.values(latestTemperature);
                    var jsonTemperatureValue = JSON.stringify(temperatureValue);

                    jsonTemperatureValue = jsonTemperatureValue.split(":").pop();
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("\"", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("}", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("]", "");

                    var iterator = temperatureArray.values();
                    console.log(iterator);
                    var dateArray = [];
                    var temperatureValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        console.log(dateArray);
                        let cleanTemperature = JSON.stringify(Object.values(elements));
                        cleanTemperature = cleanTemperature.split(":").pop();
                        cleanTemperature = cleanTemperature.replaceAll("\"", "");
                        cleanTemperature = cleanTemperature.replaceAll("}", "");
                        cleanTemperature = cleanTemperature.replaceAll("]", "");
                        console.log(cleanTemperature);
                        temperatureValueArray.push(cleanTemperature);
                        console.log(temperatureValueArray);
                    }

                    new Chart("temperatureChart", {
                        type: "line",
                        data: {
                            labels: dateArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: temperatureValueArray
                            }]
                        },
                        options: {
                            legend: { display: false },
                            scales: {
                                yAxes: [{ ticks: { min: 10.00, max: 45.00 } }],
                            }
                        }
                    });
                });
            }

            function selectAirQualityOption() {
                var selectedAirDate = document.getElementById("airQualityDateArr").value;
                console.log(selectedAirDate);
                let selectedDayAir = 'MQ2/air_quality/' + selectedAirDate;
                console.log(selectedDayAir);
                firebase.database().ref(selectedDayAir).on('value', (snap) => {
                    var airQualityStr = snap.val();
                    var airQualityArray = [];

                    Object.keys(airQualityStr).forEach((key) => {
                        airQualityArray.push({ [key]: airQualityStr[key] });
                    });
                    console.log(airQualityArray);

                    var latestAirQuality = airQualityArray[airQualityArray.length - 1];
                    var airQualityVal = Object.values(latestAirQuality);
                    var jsonAirQualityVal = JSON.stringify(airQualityVal);

                    jsonAirQualityVal = jsonAirQualityVal.split(":").pop();
                    jsonAirQualityVal = jsonAirQualityVal.replaceAll("\"", "");
                    jsonAirQualityVal = jsonAirQualityVal.replaceAll("}", "");
                    jsonAirQualityVal = jsonAirQualityVal.replaceAll("]", "");

                    var iterator = airQualityArray.values();
                    console.log(iterator);
                    var dateArray = [];
                    var airValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        console.log(dateArray);
                        let cleanAirQuality = JSON.stringify(Object.values(elements));
                        cleanAirQuality = cleanAirQuality.split(":").pop();
                        cleanAirQuality = cleanAirQuality.replaceAll("\"", "");
                        cleanAirQuality = cleanAirQuality.replaceAll("}", "");
                        cleanAirQuality = cleanAirQuality.replaceAll("]", "");
                        console.log(cleanAirQuality);
                        airValueArray.push(cleanAirQuality);
                        console.log(airValueArray);
                    }

                    new Chart("airQualityChart", {
                        type: "line",
                        data: {
                            labels: dateArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: airValueArray
                            }]
                        },
                        options: {
                            legend: { display: false },
                            scales: {
                                yAxes: [{ ticks: { min: 0.00, max: 2000.00 } }],
                            }
                        }
                    });
                });
            }

            document.addEventListener('DOMContentLoaded', function () {

                var temperatureModal = document.getElementById("temperatureModal");
                var humidityModal = document.getElementById("humidityModal");
                var airQualityModal = document.getElementById("airQualityModal");

                var temperatureBtn = document.getElementById("temperatureIndicator");
                var humidityBtn = document.getElementById("humidityIndicator");
                var airQualityBtn = document.getElementById("airQualityIndicator");

                var smokeModal = document.getElementById("smokeModal");
                var lpgModal = document.getElementById("lpgModal");
                var coModal = document.getElementById("coModal");

                var smokeBtn = document.getElementById("smokeIndicator");
                var lpgBtn = document.getElementById("lpgIndicator");
                var coBtn = document.getElementById("coIndicator");

                var span1 = document.getElementsByClassName("close")[0];
                var span2 = document.getElementsByClassName("close")[1];
                var span3 = document.getElementsByClassName("close")[2];
                var span4 = document.getElementsByClassName("close")[3];
                var span5 = document.getElementsByClassName("close")[4];
                var span6 = document.getElementsByClassName("close")[5];

                // When the user clicks on the button, open the tempModal
                temperatureBtn.onclick = function () {
                    temperatureModal.style.display = "block";
                }

                humidityBtn.onclick = function () {
                    humidityModal.style.display = "block";
                }

                airQualityBtn.onclick = function () {
                    airQualityModal.style.display = "block";
                }

                smokeBtn.onclick = function () {
                    smokeModal.style.display = "block";
                }

                lpgBtn.onclick = function () {
                    lpgModal.style.display = "block";
                }

                coBtn.onclick = function () {
                    console.log('Hello')
                    coModal.style.display = "block";
                }



                // When the user clicks on <span> (x), close the tempModal
                span1.onclick = function () {
                    temperatureModal.style.display = "none";

                }

                span2.onclick = function () {
                    humidityModal.style.display = "none";
                }

                span3.onclick = function () {
                    airQualityModal.style.display = "none";
                }

                span4.onclick = function () {
                    smokeModal.style.display = "none";

                }

                span5.onclick = function () {
                    lpgModal.style.display = "none";
                }

                span6.onclick = function () {
                    coModal.style.display = "none";
                }

                // When the user clicks anywhere outside of the tempModal, close it
                window.onclick = function (event) {
                    if (event.target === temperatureModal) {
                        temperatureModal.style.display = "none";
                    }
                    if (event.target === humidityModal) {
                        humidityModal.style.display = "none";
                    }
                    if (event.target === airQualityModal) {
                        airQualityModal.style.display = "none";
                    }
                    if (event.target === smokeModal) {
                        smokeModal.style.display = "none";
                    }
                    if (event.target === coModal) {
                        coModal.style.display = "none";
                    }
                    if (event.target === lpgModal) {
                        lpgModal.style.display = "none";
                    }
                }

                const loadEl = document.querySelector('#load');
                var today = new Date();
                var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();
                let currentDayTemperature = 'DHT11/Temperature/' + date;
                let currentDayHumidity = 'DHT11/Humidity/' + date;
                let currentDayAirQuality = 'MQ135/air_quality/' + date;

                console.log(currentDayTemperature);

                firebase.database().ref(currentDayTemperature).on('value', (snap) => {
                    var temperatureStr = snap.val();
                    var temperatureArray = [];

                    Object.keys(temperatureStr).forEach((key) => {
                        temperatureArray.push({ [key]: temperatureStr[key] });
                    });
                    console.log(temperatureArray);

                    var latestTemperature = temperatureArray[temperatureArray.length - 1];
                    var timeStr = Object.keys(latestTemperature);
                    var temperatureValue = Object.values(latestTemperature);
                    var jsonTemperatureValue = JSON.stringify(temperatureValue);

                    jsonTemperatureValue = jsonTemperatureValue.split(":").pop();
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("\"", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("}", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("]", "");
                    if (jsonTemperatureValue > 26) {
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#128293';
                        // document.getElementById("temperatureIndicator").style.backgroundColor = "#bd1816";

                    }
                    if (jsonTemperatureValue >= 23 && jsonTemperatureValue <= 26) {
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#127777';
                        // document.getElementById("temperatureIndicator").style.backgroundColor = "#bd1816";

                    }
                    if (jsonTemperatureValue <= 22) {
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#x2744';
                        // document.getElementById("temperatureIndicator").style.backgroundColor = "#1184e8";

                    }

                    document.getElementById('latestTemperature').innerHTML = jsonTemperatureValue;
                    document.getElementById('currentDate').innerHTML = "Date: " + date;
                    document.getElementById('currentTime').innerHTML = "Time: " + timeStr;

                    var iterator = temperatureArray.values();

                    console.log(iterator);
                    // Here all the elements of the array is being printed.
                    var dateArray = [];
                    var temperatureValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        console.log(dateArray);
                        let cleanTemperature = JSON.stringify(Object.values(elements));
                        cleanTemperature = cleanTemperature.split(":").pop();
                        cleanTemperature = cleanTemperature.replaceAll("\"", "");
                        cleanTemperature = cleanTemperature.replaceAll("}", "");
                        cleanTemperature = cleanTemperature.replaceAll("]", "");
                        console.log(cleanTemperature);
                        temperatureValueArray.push(cleanTemperature);
                        console.log(temperatureValueArray);
                    }

                    new Chart("temperatureChart", {
                        type: "line",
                        data: {
                            labels: dateArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: temperatureValueArray
                            }]
                        },
                        options: {
                            legend: { display: false },
                            scales: {
                                yAxes: [{ ticks: { min: 10.00, max: 45.00 } }],
                            }
                        }
                    });
                });
                var select = document.getElementById("temperatureDateArray");
                var select1 = document.getElementById("humidityDateArray");
                var select2 = document.getElementById("airQualityDateArr");

                firebase.database().ref('DHT11/Temperature/').once('value', (snap) => {
                    var temperatureDays = snap.val();
                    console.log(temperatureDays);
                    temperatureDays = Object.keys(temperatureDays);
                    console.log(temperatureDays);
                    // var select = document.getElementById("tempDateArr");
                    for (var i = 0; i < temperatureDays.length; i++) {
                        var option = temperatureDays[i];
                        var el = document.createElement("option");
                        el.textContent = option;
                        el.value = option;
                        select.prepend(el);
                    }
                    document.getElementById("temperatureDateArray").selectedIndex = "0";
                });

                firebase.database().ref('DHT11/Humidity/').once('value', (snap) => {
                    var humidityDays = snap.val();
                    console.log(humidityDays);
                    humidityDays = Object.keys(humidityDays);
                    console.log(humidityDays);
                    for (var i = 0; i < humidityDays.length; i++) {
                        var option = humidityDays[i];
                        var el = document.createElement("option");
                        el.textContent = option;
                        el.value = option;
                        select1.prepend(el);
                    }
                    document.getElementById("humidityDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayHumidity).on('value', (snap) => {
                    var humidityStr = snap.val();
                    var humidityArray = [];
                    Object.keys(humidityStr).forEach((key) => {
                        humidityArray.push({ [key]: humidityStr[key] });
                    });
                    console.log(humidityArray);

                    var latestHumidity = humidityArray[humidityArray.length - 1];
                    var humidityValue = Object.values(latestHumidity);
                    var jsonHumidityValue = JSON.stringify(humidityValue);

                    jsonHumidityValue = jsonHumidityValue.split(":").pop();
                    jsonHumidityValue = jsonHumidityValue.replaceAll("\"", "");
                    jsonHumidityValue = jsonHumidityValue.replaceAll("}", "");
                    jsonHumidityValue = jsonHumidityValue.replaceAll("]", "");
                    // if (jsonHumidityValue >= 80) {
                    //     jsonHumidityValue = jsonHumidityValue + "%";
                    // }
                    // if (jsonHumidityValue >= 70 && jsonHumidityValue < 80) {
                    //     jsonHumidityValue = jsonHumidityValue + "%" + '&#128308';
                    // }
                    if (jsonHumidityValue >= 70) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128308';
                    }
                    if (jsonHumidityValue >= 60 && jsonHumidityValue < 70) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128993';
                        // document.getElementById("humidityIndicator").style.backgroundColor = "#1184e8";
                    }
                    if (jsonHumidityValue >= 30 && jsonHumidityValue < 60) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128994';
                        // document.getElementById("humidityIndicator").style.backgroundColor = "#1184e8";
                    }
                    // jsonHumidityValue = jsonHumidityValue + "%";

                    console.log(Object.keys(latestHumidity));
                    document.getElementById('latestHumidity').innerHTML = jsonHumidityValue;
                    var iterator = humidityArray.values();

                    console.log(iterator);
                    // Here all the elements of the array is being printed.
                    var dateArray = [];
                    var temperatureValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        console.log(dateArray);
                        let cleanTemperature = JSON.stringify(Object.values(elements));
                        cleanTemperature = cleanTemperature.split(":").pop();
                        cleanTemperature = cleanTemperature.replaceAll("\"", "");
                        cleanTemperature = cleanTemperature.replaceAll("}", "");
                        cleanTemperature = cleanTemperature.replaceAll("]", "");
                        console.log(cleanTemperature);
                        temperatureValueArray.push(cleanTemperature);
                        console.log(temperatureValueArray);
                    }

                    new Chart("humidityChart", {
                        type: "line",
                        data: {
                            labels: dateArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: temperatureValueArray
                            }]
                        },
                        options: {
                            legend: { display: false },
                            scales: {
                                yAxes: [{ ticks: { min: 20.00, max: 90.00 } }],
                            }
                        }
                    });
                });

                firebase.database().ref('MQ135/air_quality/').once('value', (snap) => {
                    var airDays = snap.val();
                    console.log(airDays);
                    airDays = Object.keys(airDays);
                    console.log(airDays);
                    for (var i = 0; i < airDays.length; i++) {
                        var option = airDays[i];
                        var el = document.createElement("option");
                        el.textContent = option;
                        el.value = option;
                        select2.prepend(el);
                    }
                    document.getElementById("airQualityDateArr").selectedIndex = "0";
                });

                firebase.database().ref(currentDayAirQuality).on('value', (snap) => {
                    var airQualityStr = snap.val();
                    var airQualityArray = [];
                    Object.keys(airQualityStr).forEach((key) => {
                        airQualityArray.push({ [key]: airQualityStr[key] });
                    });
                    console.log(airQualityArray);

                    var latestAirQuality = airQualityArray[airQualityArray.length - 1];
                    var airQualityVal = Object.values(latestAirQuality);
                    var jsonAirQualityVal = JSON.stringify(airQualityVal);

                    jsonAirQualityVal = jsonAirQualityVal.split(":").pop();
                    jsonAirQualityVal = jsonAirQualityVal.replaceAll("\"", "");
                    jsonAirQualityVal = jsonAirQualityVal.replaceAll("}", "");
                    jsonAirQualityVal = jsonAirQualityVal.replaceAll("]", "");

                    if (jsonAirQualityVal >= 800) {
                        jsonAirQualityVal = jsonAirQualityVal + 'ppm' + '&#128128;';
                        document.getElementById("airQualityIndicator").style.backgroundColor = "red";
                    }
                    if (jsonAirQualityVal >= 600 && jsonAirQualityVal <= 799) {
                        jsonAirQualityVal = jsonAirQualityVal + 'ppm' + '&#128567;';
                        document.getElementById("airQualityIndicator").style.backgroundColor = "	#FFA500";
                    }
                    if (jsonAirQualityVal <= 599) {
                        jsonAirQualityVal = jsonAirQualityVal + 'ppm' + '&#128516;';
                        document.getElementById("airQualityIndicator").style.backgroundColor = "#4CBB17";
                    }

                    console.log(Object.keys(latestAirQuality));
                    document.getElementById('latestAirQuality').innerHTML = jsonAirQualityVal;
                    var iterator = airQualityArray.values();

                    console.log(iterator);
                    // Here all the elements of the array is being printed.
                    var dateArray = [];
                    var airQualityValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        console.log(dateArray);
                        let cleanAirQuality = JSON.stringify(Object.values(elements));
                        cleanAirQuality = cleanAirQuality.split(":").pop();
                        cleanAirQuality = cleanAirQuality.replaceAll("\"", "");
                        cleanAirQuality = cleanAirQuality.replaceAll("}", "");
                        cleanAirQuality = cleanAirQuality.replaceAll("]", "");
                        console.log(cleanAirQuality);
                        airQualityValueArray.push(cleanAirQuality);
                        console.log(airQualityValueArray);
                    }

                    new Chart("airQualityChart", {
                        type: "line",
                        data: {
                            labels: dateArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: airQualityValueArray
                            }]
                        },
                        options: {
                            legend: { display: false },
                            scales: {
                                yAxes: [{ ticks: { min: 0.00, max: 2000.00 } }],
                            }
                        }
                    });
                });
            });

        </script>
</body>

</html>
